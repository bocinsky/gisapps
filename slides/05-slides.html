<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Complete factorial designs</title>
    <meta charset="utf-8" />
    <meta name="author" content="Léo Belzile" />
    <meta name="date" content="2022-09-29" />
    <script src="libs/header-attrs-2.14/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.6/tile-view.js"></script>
    <link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
    <script src="libs/panelset-0.2.6/panelset.js"></script>
    <script src="libs/clipboard-2.0.6/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <script src="libs/js-cookie-3.0.0/js.cookie.js"></script>
    <script src="libs/peerjs-1.3.1/peerjs.min.js"></script>
    <script src="libs/tiny.toast-1.0.0/toast.min.js"></script>
    <link href="libs/xaringanExtra-broadcast-0.2.6/broadcast.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-broadcast-0.2.6/broadcast.js"></script>
    <script src="libs/freezeframe-5.0.2/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe-0.0.1/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/ath-slides.css" type="text/css" />
    <link rel="stylesheet" href="css/ath-inferno-fonts.css" type="text/css" />
    <link rel="stylesheet" href="css/animate.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">






class: center middle main-title section-title-1

# Complete factorial designs

.class-info[

**Session 5**

.light[MATH 80667A: Experimental Design and Statistical Methods &lt;br&gt;for Quantitative Research in Management &lt;br&gt;
HEC Montréal
]

]

---

name: outline
class: title title-inv-1

# Outline



.box-4.medium.sp-after-half[Factorial designs and interactions]



.box-5.medium.sp-after-half[Model formulation]

.box-6.medium.sp-after-half[Multifactorial designs]



---

layout: false
name: factorial-interaction
class: center middle section-title section-title-4 animated fadeIn

# Factorial designs and interactions

---

layout: true
class: title title-4

---

# Complete factorial designs?

.box-inv-4.sp-after[
.large[**Factorial design**]&lt;br&gt; study with multiple factors (subgroups)
]


.box-inv-4[.large[**Complete**]
&lt;br&gt;Gather observations for every subgroup]

---

# Motivating example

.box-inv-4[**Response**:&lt;br&gt; retention of information &lt;br&gt;two hours after reading a story]

.box-inv-4[**Population**:&lt;br&gt; children aged four]


.box-inv-4.align-left[**experimental factor 1**:&lt;br&gt; ending (happy or sad)]

.box-inv-4[**experimental factor 2**:&lt;br&gt; complexity (easy, average or hard).]




---

# Setup of design



<div id="mlqhdevnwr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#mlqhdevnwr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 40px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mlqhdevnwr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlqhdevnwr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mlqhdevnwr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mlqhdevnwr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlqhdevnwr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlqhdevnwr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 40px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mlqhdevnwr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 40px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mlqhdevnwr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mlqhdevnwr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mlqhdevnwr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mlqhdevnwr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#mlqhdevnwr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mlqhdevnwr .gt_from_md > :first-child {
  margin-top: 0;
}

#mlqhdevnwr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mlqhdevnwr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mlqhdevnwr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mlqhdevnwr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mlqhdevnwr .gt_row_group_first td {
  border-top-width: 2px;
}

#mlqhdevnwr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlqhdevnwr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mlqhdevnwr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mlqhdevnwr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlqhdevnwr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlqhdevnwr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mlqhdevnwr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mlqhdevnwr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlqhdevnwr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlqhdevnwr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlqhdevnwr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlqhdevnwr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlqhdevnwr .gt_left {
  text-align: left;
}

#mlqhdevnwr .gt_center {
  text-align: center;
}

#mlqhdevnwr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mlqhdevnwr .gt_font_normal {
  font-weight: normal;
}

#mlqhdevnwr .gt_font_bold {
  font-weight: bold;
}

#mlqhdevnwr .gt_font_italic {
  font-style: italic;
}

#mlqhdevnwr .gt_super {
  font-size: 65%;
}

#mlqhdevnwr .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#mlqhdevnwr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#mlqhdevnwr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mlqhdevnwr .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#mlqhdevnwr .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#mlqhdevnwr .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table" style="table-layout: fixed;">
  <colgroup>
    <col/>
    <col style="width:120px;"/>
    <col style="width:120px;"/>
  </colgroup>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">complexity</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">happy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sad</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">complicated</td>
<td class="gt_row gt_right" style="background-color: rgba(255,179,186,0.8); color: #000000;"><img src="data:image/png;base64,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" style="height:80px;"></td>
<td class="gt_row gt_right" style="background-color: rgba(255,179,186,0.8); color: #000000;"><img src="data:image/png;base64,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" style="height:80px;"></td></tr>
    <tr><td class="gt_row gt_left">average</td>
<td class="gt_row gt_right" style="background-color: rgba(255,223,186,0.8); color: #000000;"><img src="data:image/png;base64,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" style="height:80px;"></td>
<td class="gt_row gt_right" style="background-color: rgba(255,223,186,0.8); color: #000000;"><img src="data:image/png;base64,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" style="height:80px;"></td></tr>
    <tr><td class="gt_row gt_left">simple</td>
<td class="gt_row gt_right" style="background-color: rgba(186,225,255,0.8); color: #000000;"><img src="data:image/png;base64,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" style="height:80px;"></td>
<td class="gt_row gt_right" style="background-color: rgba(186,225,255,0.8); color: #000000;"><img src="data:image/png;base64,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" style="height:80px;"></td></tr>
  </tbody>
  
  
</table>
</div>


.box-inv-4[Factors are crossed]


---

# Efficiency of factorial design

.box-inv-4.sp-after.medium[Cast problem&lt;br&gt;as a series of one-way ANOVA &lt;br&gt; vs simultaneous estimation]


.box-4.medium.sp-before[Factorial designs requires&lt;br&gt; **fewer overall observations**]

.box-4.medium.sp-before[Can study **interactions**]

???

To study each interaction (complexity, story book ending) we would need to make three group for each comparison in rows, and one in each column. So a total of 3 one-way ANOVA each with  2 groups and 2 one-way anova with 3 groups. The two-way ANOVA will lead to 6 groups instead of 12.

---

# Interaction

.box-inv-4.sp-after.medium[
**Definition**: when the effect of one factor&lt;br&gt; depends on the levels of another factor.
]

.box-inv-4[
Effect together&lt;br&gt;
`\(\neq\)`
&lt;br&gt; sum of individual effects
]

---

# Interaction or profile plot
.box-inv-4.large.sp-after[Graphical display: &lt;br&gt;plot sample mean per category]

.box-4.sp-after-half[with uncertainty measure&lt;br&gt;(1 std. error for mean&lt;br&gt;confidence interval, etc.)]



---

# Interaction: lines are not parallel

&lt;img src="05-slides_files/figure-html/interaction_plots2-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# No interaction: parallel lines

&lt;img src="05-slides_files/figure-html/interaction_plots1-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---

# Interaction plot for 2 by 2 design

&lt;img src="05-slides_files/figure-html/2by2-interaction-1.png" width="80%" style="display: block; margin: auto;" /&gt;


???

Line graph for example patterns for means for each of the possible kinds of general outcomes in a 2 by 2 design. Illustration adapted from Figure 10.2 of Crump, Navarro and Suzuki (2019) by Matthew Crump (CC BY-SA 4.0 license)

---

layout: false
name: formulation
class: center middle section-title section-title-5 animated fadeIn

# Model formulation

---

layout: true
class: title title-5

---

# Formulation of the two-way ANOVA

Two factors: `\(A\)` (complexity) and `\(B\)` (ending) with `\(n_a\)` and `\(n_b\)` levels.

Write the average response `\(Y_{ijr}\)` of the `\(r\)`th measurement in group `\((a_i, b_j)\)` as
`\begin{align*}
\underset{\text{response}\vphantom{b}}{Y_{ijr}} = \underset{\text{subgroup mean}}{\mu_{ij}} + \underset{\text{error term}}{\varepsilon_{ijr}}
\end{align*}`
where 

- `\(Y_{ijr}\)` is the `\(r\)`th replicate for `\(i\)`th level of factor `\(A\)` and `\(j\)`th level of factor `\(B\)`
- `\(\varepsilon_{ijr}\)` are independent error terms with mean zero and variance `\(\sigma^2\)`.

---
# One average for each subgroup

| `\(\qquad B\)` `ending`&lt;br&gt; `\(A\)` `complexity` `\(\qquad\)` | `\(b_1\)` (`happy`) | `\(b_2\)` (`sad`)| *row mean* |
|------------|:----------:|:-----:|:-----:|
| `\(a_1\)` (`complicated`) | `\(\mu_{11}\)` | `\(\mu_{12}\)` | `\(\mu_{1.}\)` |
|  `\(a_2\)` (`average`)  | `\(\mu_{21}\)` | `\(\mu_{22}\)` | `\(\mu_{2.}\)` |
| `\(a_3\)` (`simple`) |  `\(\mu_{31}\)` | `\(\mu_{32}\)` | `\(\mu_{3.}\)` |
|*column mean* | `\(\mu_{.1}\)` | `\(\mu_{.2}\)` | `\(\mu\)` |


---

# Row, column and overall average

.pull-left[

- Mean of `\(A_i\)` (average of row `\(i\)`): 
`$$\mu_{i.} = \frac{\mu_{i1} + \cdots + \mu_{in_b}}{n_b}$$`

- Mean of `\(B_j\)` (average of column `\(j\)`):
`$$\mu_{.j} = \frac{\mu_{1j} + \cdots + \mu_{n_aj}}{n_a}$$`

]
.pull-right[
- Overall average (overall all rows and columns):
`$$\mu = \frac{\sum_{i=1}^{n_a} \sum_{j=1}^{n_b} \mu_{ij}}{n_an_b}$$`

]

---


# Vocabulary of effects
.pull-left[
.box-5[Definitions]
- .color-5[**simple effects**]: difference between levels of one in a fixed combination of others (change in difficulty for happy ending)
- .color-5[**main effects**]: differences relative to average for each condition of a factor (happy vs sad ending)
- .color-5[**interaction effects**]: when simple effects differ depending on levels of another factor
]
.pull-right[
.box-5[What it means relative to the table]

- .color-5[**simple effects**] are comparisons between cell averages within a given row or column


- .color-5[**main effects**] are comparisons between row or column averages


- .color-5[**interaction effects**] are difference relative to the row or column average

]
---


# Contrasts

Suppose the order of the coefficients is factor `\(A\)` (complexity, 3 levels, complicated/average/easy) and factor `\(B\)` (ending, 2 levels, happy/sad).

| test | `\(\mu_{11}\)` | `\(\mu_{12}\)` | `\(\mu_{21}\)` | `\(\mu_{22}\)` | `\(\mu_{31}\)` | `\(\mu_{32}\)` |
|:--|--:|--:|--:|--:|--:|--:|
| main effect `\(A\)` (complicated vs average) |  `\(1\)` | `\(1\)` | `\(-1\)` |  `\(-1\)` | `\(0\)` | `\(0\)` |
| main effect `\(A\)` (complicated vs simple) |    `\(1\)` |  `\(1\)` | `\(0\)` | `\(0\)` | `\(-1\)` |  `\(-1\)` |
| main effect `\(B\)` (happy vs sad) |    `\(1\)` |  `\(-1\)` | `\(1\)` |  `\(-1\)` | `\(1\)` | `\(-1\)` |
| interaction `\(AB\)` (comp. vs av, happy vs sad) | `\(1\)` | `\(-1\)` | `\(-1\)` | `\(1\)` | `\(0\)` | `\(0\)` |
| interaction `\(AB\)` (comp. vs easy, happy vs sad) |  `\(1\)` | `\(-1\)` | `\(0\)` | `\(0\)` | `\(-1\)` | `\(1\)` |

---

# Hypothesis tests for main effects

Generally, need to compare multiple effects at once
.box-inv-5.sp-after-half[
Main effect of factor `\(A\)`
]

`\(\mathscr{H}_0\)`: `\(\mu_{1.} = \cdots = \mu_{a.}\)` vs `\(\mathscr{H}_a\)`: at least two marginal means of `\(A\)` are different
.box-inv-5.sp-after-half[
Main effect of factor `\(B\)`
]

`\(\mathscr{H}_0\)`: `\(\mu_{.1} = \cdots = \mu_{.b}\)` vs `\(\mathscr{H}_a\)`: at least two marginal means of `\(B\)` are different.

---
# Equivalent formulation of the two-way ANOVA

Write the model for a response variable `\(Y\)` in terms of two factors `\(a_i\)`, `\(b_j\)`.

`$$Y_{ijr} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \varepsilon_{ijr}$$`

where 
- `\(\alpha_i = \mu_{i.} - \mu\)`
    - mean of level `\(a_i\)` minus overall mean.
- `\(\beta_j  = \mu_{.j} - \mu\)`
    - mean of level `\(b_j\)` minus overall mean.
- `\((\alpha\beta)_{ij} = \mu_{ij} - \mu_{i.} - \mu_{.j} + \mu\)`
    - the interaction term for `\(a_i\)` and `\(b_j\)`.

---

# One average for each subgroup

.small[

| `\(\qquad B\)` `ending`&lt;br&gt; `\(A\)` `complexity` `\(\qquad\)` | `\(b_1\)` (`happy`) | `\(b_2\)` (`sad`)| *row mean* |
|------------|:----------:|:-----:|:-----:|
| `\(a_1\)` (`complicated`) | `\(\mu + \alpha_1 + \beta_1 + (\alpha\beta)_{11}\)` | `\(\mu + \alpha_1 + \beta_2 + (\alpha\beta)_{12}\)` | `\(\mu + \alpha_1\)` |
|  `\(a_2\)` (`average`)  | `\(\mu + \alpha_2 + \beta_1 + (\alpha\beta)_{21}\)` | `\(\mu + \alpha_2 + \beta_2 + (\alpha\beta)_{22}\)` | `\(\mu + \alpha_2\)` |
| `\(a_3\)` (`simple`) |  `\(\mu + \alpha_3 + \beta_1 + (\alpha\beta)_{31}\)` | `\(\mu + \alpha_3 + \beta_2 + (\alpha\beta)_{32}\)` | `\(\mu + \alpha_3\)` |
|*column mean* | `\(\mu + \beta_1\)` | `\(\mu + \beta_2\)` | `\(\mu\)` |

]


.box-inv-5[More parameters than data cells!]

The model in terms of `\(\alpha\)`, `\(\beta\)` and `\((\alpha\beta)\)` is overparametrized.


---


# Sum-to-zero parametrization

.box-inv-5[Too many parameters!]


Impose sum to zero constraints

`$$\sum_{i=1}^{n_a} \alpha_i=0, \quad \sum_{j=1}^{n_b} \beta_j=0, \quad  \sum_{j=1}^{n_b} (\alpha\beta)_{ij}=0, \quad \sum_{i=1}^{n_a} (\alpha\beta)_{ij}=0.$$`

which imposes `\(1 +  n_a + n_b\)` constraints.

---

# Why use the sum to zero parametrization?

- Testing for main effect of `\(A\)`: `$$\mathscr{H}_0: \alpha_1 = \cdots = \alpha_{n_a} = 0$$`
- Testing for main effect of `\(B\)`: `$$\mathscr{H}_0: \beta_1 = \cdots = \beta_{n_b} = 0$$` 
- Testing for interaction between `\(A\)` and `\(B\)`: `$$\mathscr{H}_0: (\alpha\beta)_{11} = \cdots = (\alpha\beta)_{n_an_b} = 0$$`

In all cases, alternative is that at least two coefficients are different.

---

# Seeking balance

.box-inv-5.sp-after.medium[
**Balanced sample**&lt;br&gt;
(equal nb of obs per group)

]

.box-inv-5[
With `\(n_r\)` replications per subgroup,&lt;br&gt;total sample size is `\(n = n_an_bn_r\)`.
]

---

# Why balanced design?

With equal variance, this is the optimal allocation of treatment unit.

.box-inv-5.sp-after.medium[maximize power]

Estimated means for main and total effects correspond to marginal averages.

.box-inv-5.sp-after.medium[equiweighting]

Unambiguous decomposition of effects of `\(A\)`, `\(B\)` and interaction.

.box-inv-5.sp-after.medium[orthogonality]

---

# Rewriting observations


`\begin{align*}
\underset{\text{obs vs grand mean}}{(y_{ijr} - \widehat{\mu})} &amp;= 
\underset{\text{row mean vs grand mean}}{(\widehat{\mu}_{i.} - \widehat{\mu})} \\&amp; +\underset{\text{col mean vs grand mean}}{(\widehat{\mu}_{.j} - \widehat{\mu})} \\&amp;+
\underset{\text{cell mean vs additive effect}}{(\widehat{\mu}_{ij} - \widehat{\mu}_{i.} - \widehat{\mu}_{.j}+ \widehat{\mu})} \\&amp;+ \underset{\text{obs vs cell mean}}{(y_{ijr} - \widehat{\mu}_{ij})}
\end{align*}`

---

# Decomposing variability

Constructing statistics as before by decomposing variability into blocks.

We can square both sides and sum over all observations.

With balanced design, all cross terms cancel, leaving us with the .color-5[**sum of square**] decomposition

`$$\mathsf{SS}_{\text{total}} = \mathsf{SS}_A + \mathsf{SS}_B + \mathsf{SS}_{AB} + \mathsf{SS}_{\text{resid}}.$$`

---

# Sum of square decomposition

The sum of square decomposition

`$$\mathsf{SS}_{\text{total}} = \mathsf{SS}_A + \mathsf{SS}_B + \mathsf{SS}_{AB} + \mathsf{SS}_{\text{resid}}.$$`
is an estimator of the population variance decomposition
`$$\sigma^2_{\text{total}} = \sigma^2_A + \sigma^2_{B} + \sigma^2_{AB} + \sigma^2_{\text{resid}}.$$`
where `\(\sigma^2_A = n_a^{-1}\sum_{i=1}^{n_a} \alpha_i^2\)`, `\(\sigma^2_{AB} = (n_an_b)^{-1} \sum_{i=1}^{n_a} \sum_{j=1}^{n_b} (\alpha\beta)^2_{ij}\)`, etc.


Take ratio of variability (effect relative to residual) and standardize numerator and denominator to build an `\(F\)` statistic.


---
# Analysis of variance table


.small[

| term | degrees of freedom | mean square | `\(F\)` | 
|------|--------|------|--------|
| `\(A\)`  | `\(n_a-1\)`   | `\(\mathsf{MS}_{A}=\mathsf{SS}_A/(n_a-1)\)` | `\(\mathsf{MS}_{A}/\mathsf{MS}_{\text{res}}\)` |
| `\(B\)`  | `\(n_b-1\)`   | `\(\mathsf{MS}_{B}=\mathsf{SS}_B/(n_b-1)\)` | `\(\mathsf{MS}_{B}/\mathsf{MS}_{\text{res}}\)` |
| `\(AB\)` | `\((n_a-1)(n_b-1)\)` | `\(\mathsf{MS}_{AB}=\mathsf{SS}_{AB}/\{(n_a-1)(n_b-1)\}\)` | `\(\mathsf{MS}_{AB}/\mathsf{MS}_{\text{res}}\)` |
| residuals | `\(n-n_an_b\)` | `\(\mathsf{MS}_{\text{resid}}=\mathsf{SS}_{\text{res}}/ (n-ab)\)` | |
| total | `\(n-1\)` | | 

]

Read the table backward (starting with the interaction).
- If there is a significant interaction, the main effects are **not** of interest and potentially misleading.

---

# Intuition behind degrees of freedom

| `\(\qquad B\)` `ending`&lt;br&gt; `\(A\)` `complexity` `\(\qquad\)` | `\(b_1\)` (`happy`) | `\(b_2\)` (`sad`)| *row mean* |
|------------|:----------:|:-----:|:-----:|
| `\(a_1\)` (`complicated`) | `\(\mu_{11}\)` | `\(\mathsf{X}\)` | `\(\mu_{1.}\)` |
|  `\(a_2\)` (`average`)  | `\(\mu_{21}\)` | `\(\mathsf{X}\)`  | `\(\mu_{2.}\)` |
| `\(a_3\)` (`simple`) |  `\(\mathsf{X}\)`  | `\(\mathsf{X}\)`  | `\(\mathsf{X}\)` |
|*column mean* | `\(\mu_{.1}\)` | `\(\mathsf{X}\)` | `\(\mu\)` |

.small[ 
Terms with `\(\mathsf{X}\)` are fully determined by row/column/total averages

]

---

# Multiplicity correction

With equal sample size and equal variance, usual recipes for ANOVA hold.

Correction depends on the effect: e.g., for factor `\(A\)`, the critical values are

- Bonferroni: `\(1-\alpha/(2m)\)` quantile of `\(\mathsf{St}(n-n_an_b)\)`
- Tukey: Studentized range (`qtukey`)
   - level `\(1-\alpha/2\)`, `\(n_a\)` groups, `\(n-n_an_b\)` degrees of freedom.
- Scheffé: critical value is `\(\{(a-1) \mathfrak{f}_{1-\alpha}\}^{1/2}\)`
   - `\(\mathfrak{f}_{1-\alpha}\)` is `\(1-\alpha\)` quantile of `\(\mathsf{F}(\nu_1 = n_a-1, \nu_2 = n-n_an_b)\)`.

Software implementations available in `emmeans` in **R**.

---


layout: false
name: factorial-designs
class: center middle section-title section-title-5 animated fadeIn

# Numerical example

---

layout: false
name: factorial-designs
class: center middle section-title section-title-6 animated fadeIn

# Multifactorial designs

---

class: title title-6
# Beyond two factors

We can consider multiple factors `\(A\)`, `\(B\)`, `\(C\)`, `\(\ldots\)` with respectively `\(n_a\)`, `\(n_b\)`, `\(n_c\)`, `\(\ldots\)` levels and with `\(n_r\)` replications for each.

The total number of treatment combinations is 

.box-inv-6.sp-after-half[
`\(n_a \times n_b \times n_c \times \cdots\)`
]


--

.box-6.medium[
**Curse of dimensionality**
]

---

class: title title-6
# Full three-way ANOVA model

Each cell of the cube is allowed to have a different mean

`$$\begin{align*}
\underset{\text{response}\vphantom{cell}}{Y_{ijkr}\vphantom{\mu_{j}}} = \underset{\text{cell mean}}{\mu_{ijk}} + \underset{\text{error}\vphantom{cell}}{\varepsilon_{ijkr}\vphantom{\mu_{j}}}
\end{align*}$$`
with `\(\varepsilon_{ijkt}\)` are independent error term for 
- row `\(i\)`
- column `\(j\)`
- depth `\(k\)`
- replication `\(r\)`

---
class: title title-6
# Parametrization of a three-way ANOVA model

With the **sum-to-zero** parametrization with factors `\(A\)`, `\(B\)` and `\(C\)`, write the response as

`$$\begin{align*}\underset{\text{theoretical average}}{\mathsf{E}(Y_{ijkr})} &amp;= \quad \underset{\text{global mean}}{\mu} \\ &amp;\quad +\underset{\text{main effects}}{\alpha_i + \beta_j + \gamma_k}  \\ &amp; \quad + \underset{\text{two-way interactions}}{(\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk}} \\ &amp; \quad + \underset{\text{three-way interaction}}{(\alpha\beta\gamma)_{ijk}}\end{align*}$$`

---
.small[
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="img/05/cube.png" alt="global mean, row, column and depth main effects" width="20%" /&gt;&lt;img src="img/05/cube_rows.png" alt="global mean, row, column and depth main effects" width="20%" /&gt;&lt;img src="img/05/cube_column.png" alt="global mean, row, column and depth main effects" width="20%" /&gt;&lt;img src="img/05/cube_depth.png" alt="global mean, row, column and depth main effects" width="20%" /&gt;
&lt;p class="caption"&gt;global mean, row, column and depth main effects&lt;/p&gt;
&lt;/div&gt;
]
.small[
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="img/05/cube_rowcol.png" alt="row/col, row/depth and col/depth interactions and three-way interaction." width="20%" /&gt;&lt;img src="img/05/cube_rowdepth.png" alt="row/col, row/depth and col/depth interactions and three-way interaction." width="20%" /&gt;&lt;img src="img/05/cube_coldepth.png" alt="row/col, row/depth and col/depth interactions and three-way interaction." width="20%" /&gt;&lt;img src="img/05/cube_all.png" alt="row/col, row/depth and col/depth interactions and three-way interaction." width="20%" /&gt;
&lt;p class="caption"&gt;row/col, row/depth and col/depth interactions and three-way interaction.&lt;/p&gt;
&lt;/div&gt;
]

---
class: title title-6
# Example of three-way design

.small[
Petty, Cacioppo and Heesacker (1981). Effects of rhetorical questions on persuasion: A cognitive response analysis. Journal of Personality and Social Psychology.

A `\(2 \times 2 \times 2\)` factorial design with 8 treatments groups and `\(n=160\)` undergraduates.

Setup: should a comprehensive exam be administered to bachelor students in their final year?

- **Response** Likert scale on `\(-5\)` (do not agree at all) to `\(5\)` (completely agree)
- **Factors**
- `\(A\)`: strength of the argument (`strong` or `weak`)
- `\(B\)`: involvement of students `low` (far away, in a long time) or  `high` (next year, at their university)
- `\(C\)`: style of argument, either `regular` form or `rhetorical` (Don't you think?, ...)
]

---
class: title title-6

# Interaction plot

.small[
Interaction plot for a  `\(2 \times 2 \times 2\)` factorial design from Petty, Cacioppo and Heesacker (1981)
]

&lt;img src="05-slides_files/figure-html/interactionpetty-1.png" width="70%" style="display: block; margin: auto;" /&gt;

???

p.472 of Keppel and Wickens


---
class: title title-6
#  The microwave popcorn experiment

What is the best brand of microwave popcorn? 

- **Factors**
- brand (two national, one local)
- power: 500W and 600W
- time: 4, 4.5 and 5 minutes
- **Response**: &lt;s&gt;weight&lt;/s&gt;, &lt;s&gt;volume&lt;/s&gt;, &lt;s&gt;number&lt;/s&gt;, percentage of popped kernels.
- Pilot study showed average of 70% overall popped kernels (10% standard dev), timing values reasonable
- Power calculation suggested at least `\(r=4\)` replicates, but researchers proceeded with `\(r=2\)`...

---



.panelset[

.panel[.panel-name[ANOVA]

```r
data(popcorn, package = 'hecedsm')
# Fit model with three-way interaction
model &lt;- aov(percentage ~ brand*power*time,
             data = popcorn)
# ANOVA table - 'anova' is ONLY for balanced designs
anova_table &lt;- anova(model) 
# Quantile-quantile plot
car::qqPlot(model)
```

.small[Model assumptions: plots and tests are meaningless with `\(n_r=2\)` replications per group...]

]

.panel[.panel-name[QQ-plot]

&lt;img src="05-slides_files/figure-html/popcornplotqqplot-1.png" width="35%" style="display: block; margin: auto;" /&gt;

All points fall roughly on a straight line.

]

.panel[.panel-name[**R** code]

```r
popcorn |&gt; 
   group_by(brand, time, power) |&gt;
   summarize(meanp = mean(percentage)) |&gt;
ggplot(mapping = aes(x = power, 
                     y = meanp, 
                     col = time, 
                     group = time)) + 
  geom_line() + 
  facet_wrap(~brand)
```
]


.panel[.panel-name[Interaction plot]

&lt;img src="05-slides_files/figure-html/popcornplot2-1.png" width="80%" style="display: block; margin: auto;" /&gt;

No evidence of three-way interaction (hard to tell with `\(r=2\)` replications).
]


]

---

class: title title-6
# Analysis of variance table for balanced designs

.small[

| terms | degrees of freedom | 
|:---:|:-----|:-------|
| `\(A\)` | `\(n_a-1\)` | 
| `\(B\)` | `\(n_b-1\)` | 
| `\(C\)` | `\(n_c-1\)` | 
| `\(AB\)` | `\((n_a-1)(n_b-1)\)` | 
| `\(AC\)` | `\((n_a-1)(n_c-1)\)` | 
| `\(BC\)` | `\((n_b-1)(n_c-1)\)` | 
| `\(ABC\)` | `\({\small (n_a-1)(n_b-1)(n_c-1)}\)` | 
| `\(\text{residual}\)` | `\(n_an_bn_c(R-1)\)` | 
| `\(\text{total}\)` | `\(n_an_bn_cn_r-1\)` | 

]

---

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Analysis of variance table for microwave-popcorn&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Degrees of freedom &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sum of squares &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Mean square &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; F statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p-value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; brand &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 331.10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 165.55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.89 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.180 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; power &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 455.11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 455.11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.035 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; time &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1554.58 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 777.29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.87 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.002 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; brand:power &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 196.04 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 98.02 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.349 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; brand:time &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1433.86 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 358.46 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.09 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.016 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; power:time &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.71 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23.85 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.765 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; brand:power:time &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.33 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.83 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.967 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Residuals &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1577.87 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 87.66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: title title-6
# Omitting terms in a factorial design

The more levels and factors, the more parameters to estimate (and replications needed)
- Costly to get enough observations / power
- The assumption of normality becomes more critical when `\(r=2\)`!

It may be useful not to consider some interactions if they are known or (strongly) suspected not to be present

- If important interactions are omitted from the model, biased estimates/output!

---
class: title title-6
# Guidelines for the interpretation of effects

Start with the most complicated term (top down)

- If the three-way interaction `\(ABC\)` is significative:
    - don't interpret main effects or two-way interactions!
    - comparison is done cell by cell within each level
- If the `\(ABC\)` term isn't significative:
    - can marginalize and interpret lower order terms
    - back to a series of two-way ANOVAs

---

class: title title-6

# What contrasts are of interest?

- Can view a three-way ANOVA as a series of one-way ANOVA or two-way ANOVAs...

Depending on the goal, could compare for variable `\(A\)`
- marginal contrast `\(\psi_A\)` (averaging over `\(B\)` and `\(C\)`)
- marginal conditional contrast for particular subgroup: `\(\psi_A\)` within `\(c_1\)`
- contrast involving two variables: `\(\psi_{AB}\)`
- contrast differences between treatment at `\(\psi_A \times B\)`, averaging over `\(C\)`.
- etc.

See helper code and chapter 22 of Keppel &amp; Wickens (2004) for a detailed example.

---
class: title title-6
# Effects and contrasts for microwave-popcorn

Following preplanned comparisons

- Which combo (brand, power, time) gives highest popping rate? (pairwise comparisons of all combos)
- Best brand overall (marginal means marginalizing over power and time, assuming no interaction)
- Effect of time and power on percentage of popped kernels 
- pairwise comparison of time `\(\times\)` power
- main effect of power
- main effect of time

---

class: title title-6
# Preplanned comparisons using `emmeans`


Let `\(A\)`=brand, `\(B\)`=power, `\(C\)`=time

Compare difference between percentage of popped kernels for 4.5 versus 5 minutes, for brands 1 and 2

`$$\mathscr{H}_0: (\mu_{1.2} -\mu_{1.3}) - (\mu_{2.2} - \mu_{2.3}) = 0$$`

.small[

```r
library(emmeans)
# marginal means
emm_popcorn_AC &lt;- emmeans(model, 
                          specs = c("brand","time"))
contrast_list &lt;- 
  list(
    brand12with4.5vs5min = c(0, 0, 0, 1, -1, 0, -1, 1,0))
contrast(emm_popcorn_AC,  # marginal mean (no time)
         method = contrast_list) # list of contrasts
```


]

---

class: title title-6
# Preplanned comparisons

Compare all three times (4, 4.5 and 5 minutes)

At level 99% with Tukey's HSD method

- Careful! Potentially misleading because there is a `brand * time` interaction present.


```r
# List of variables to keep go in `specs`: keep only time
emm_popcorn_C &lt;- emmeans(model, specs = "time")
pairs(emm_popcorn_C, 
      adjust = "tukey", 
      level = 0.99, 
      infer = TRUE)
```

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": false,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
